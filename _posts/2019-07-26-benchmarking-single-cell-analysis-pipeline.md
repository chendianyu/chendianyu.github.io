---
title: 利用混合物控制实验比较 scRNA-seq 分析流程
description: scRNA-seq 的快速发展推动了各类分析方法的爆发式增长，但是目前还没有对整个分析流程进行系统比较的相关结果。本文中作者通过单细胞以及混合细胞或 RNA，模拟真实实验，对包括标准化、填补、降维、聚类、轨迹分析以及数据整合等过程相关的软件做了系统的比较
categories:
 - Single Cell
tags:
 - paper
 - single cell
 - benchmark
---

# Introduction
scRNA-seq 数据分析相关计算方法的快速发展为我们的工作带来了更多的选择，但同时也需要我们对这些方法进行系统的比较以明确不同算法的优劣势。虽然已经有一些研究针对各个分析步骤，如标准化、特征选择、差异表达分析、聚类以及轨迹分析等相关的方法进行比较，但是存在两个问题：一是他们选择的**模拟数据集预设的假设可能无法匹配实际 scRNA-seq 数据**；二是**他们针对特定步骤，而不是在整个分析流程这一层面**。因此，作者设计了一系列实验，混合来自不同细胞系的细胞或 RNA，并通过梯度稀释模拟不同细胞内 RNA 含量的差异，另外还加入 ERCCs 等，之后通过不同 scRNA-seq 平台获取数据，并基于这些数据集对整个分析流程各步骤相关软件进行比较  
  
# 实验设计
实验设计部分包含：  
* single cell 层面（下图a）：总共5个人类肺腺癌细胞系（HCC827, H1975, A549, H838 and H2228），分为两种情况：  
    * 以相同的比例混合其中3个细胞系（HCC827, H1975 and H2228）并用 CEL-seq2、10x 和 Drop-seq 分别测1组  
    * 以相同比例混合所有5个细胞系并用 CEL-seq2 测3个重复，10x 测1份  
    共计7组。**对于每个细胞系，其身份可以根据已知的遗传变异推断**。该设计主要可比较不同 protocol 的影响，以及数据整合方法的效果  
* RNA mixture 层面（下图b中黄色三角形）：从 HCC827, H1975 and H2228 细胞群中提取 RNA，以不同比例混合并稀释到单细胞水平的量（所以每个孔可视为单个细胞），总计8种不同混合物（mix1-8），其中 mix1 和 mix2 均为三种细胞各占1/3，但是是分开处理的，可用于**评估 RNA 稀释以及混合过程中引入的差异**。除了不同比例的混合外，作者还设计了一系列稀释梯度，添加的 RNA 数量为3.75，7.5,15和30pg，每组混合物在每块板上各重复6,14,14,14次（所以正好一块384孔板），从而**模拟细胞大小差异**。之后分别用 CEL-seq2 和 SORT-seq 测序，故得到2个数据集。RNA mixture 数据集中包含技术重复，梯度稀释，因此**适合比较标准化和填补方法**  
* cell mixture 层面（下图b绿色圆圈）：将 HCC827, H1975 and H2228 细胞分选至384孔板。设计的 major tracjectory （中间的三叉型）类似于上面的 RNA mixture，每种组合（共10种）是9个细胞，不同细胞系所占比例不同，构成“拟轨迹”，一块板上每种组合各20个重复。对于主轨迹，每种组合还配了一个90个细胞的群体对照，3个重复。minor tracjectory （三角形的边）上，则是两种细胞系的不同比例组合，共24种，5个重复。此外，还加了9组3:3:3组合的低质量细胞重复，9组1:1:1组合模拟小细胞的重复。除了用于轨迹分析，**通过改变细胞数和细胞质量研究这些对数据特征的影响**。含有9个细胞的孔混合后进行了抽样以得到单细胞的量。其中3个重复取1/9，1个重复取1/3。对3个重复采用了不同比例的 clean-up，从而产生完全由于技术因素导致的批次效应，并可以研究 clean-up 对数据的影响  
  
![experiment_design](/img/2019-07-26-benchmarking-single-cell-analysis-pipeline/experiment_design.png)   
  
# 质控指标检验
利用 `scPipe` 包获得各个数据集的一系列质控指标，发现来自不同平台的数据在**外显子比对率和每个细胞总 UMI 数方面表现出一致的高质量，但在内含子比对率上呈现较大差异（下图）**。利用 scran 标准化，并绘制 PCA 图，可以看到显示的结构与预期的比较一致。不同数据集 doublet 率不同  
![qc_metric](/img/2019-07-26-benchmarking-single-cell-analysis-pipeline/qc_metric.png)  
  
整个 workflow 如下图所示，经过预处理和初步质控，每个数据集被不同的方法组合分析，包括8种标准化方法，3种填补方法，7种聚类方法，5种轨迹分析方法以及6种数据整合方法  

![workflow](/img/2019-07-26-benchmarking-single-cell-analysis-pipeline/workflow.png)  
  
# 标准化和填补方法比较  
