---
title: 基于不同条件，技术和物种中共有的变异来源整合单细胞转录组数据
description: 
categories:
 - scRNA-seq
tags:
 - paper
 - scRNA-seq
 - Seurat
 - batch effects
---

在单个条件，技术或者物种中，scRNA-seq 计算方法能够成功地发现和鉴定细胞表型。但是，跨数据集的细胞亚群的鉴定仍极具挑战性。在本文中，作者基于不同 scRNA-seq 数据集中共有的变异来源，实现对不同数据集中共有的细胞群体的鉴定以及下游的比较分析，并在 Seurat 包中实现了该方法，从而实现不同 scRNA-seq 数据集的一般化比较，有望加深我们对不同细胞状态对干扰，疾病以及进化等应答的理解。

<!-- more -->
  
# Introduction
scRNA-seq 在诸多领域大放异彩，加深了我们对生命的理解。现有许多方法都能够有效地分析单一条件，技术或者物种的 scRNA-seq 数据集，但是针对不同的 scRNA-seq 数据集，例如在不同条件下比较异质性组织，或者整合不同测序技术得到的结果，仍有很大的挑战性。例如对 scRNA-seq 数据进行比较分析时，由于不同样本中各细胞类型所占比例发生了变化，以及对给定细胞类型而言，表达情况也有所不同，因此将多个数据集放在一起分析时，会导致两种本不相干的效应相互干扰。因此我们需要新的方法，能够整合不同的数据集，尤其是考虑到未来会有越来越多的数据。  
本文献中，作者受计算机视觉中为校准和整合图像数据所使用的技术启发，提出了一种新的用于 scRNA-seq 数据整合分析的策略。这种为“流形对齐”所设计的多元方法被成功应用于 scRNA-seq 数据，找出不同数据集间保守的基因-基因相关模式，从而将细胞映射至一个共享的低维空间，实现整合分析。  
  
# Seurat 校准流程概观  
为了能够比较不同条件，技术或者物种得到的 scRNA-seq 数据集，新的计算方法必须能够做到以下几点。为了更好的说明，作者以对异质性细胞群体用药和不用药时得到的 scRNA-seq 数据集为例（下图）：  
![toy_example](/img/2018-06-12-integrating-scRNA-seq-data/toy_example.png)  
  
1. 同一亚群的细胞应当对齐，即便它们有不同的药物应答反应；由于传统针对混池数据的批次效应校准方法假设某一因素对单个细胞群中所有细胞的影响是统一的，因此不适用于该情况  
2. 允许不同条件下细胞密度，即各亚群所占比例发生变化  
3. 能适应不同条件下特征的尺度范围的变化，不管是整体性的转录本变化，还是不同测序技术得到的数据集标准化策略上的差异  
4. 该过程不应针对已知的细胞类型，不需要预先构建用于匹配各亚群的标记集合  
  
Seurat 对齐流程主要包括以下几步：  
1. 利用 `canonical correlation analysis (典型关联分析, CCA)` 不同数据集间共有的基因关联结构  
2. （可选）找出无法用这个共享结构进行很好的描述的单个细胞。这可以找出那些不同数据集之间未重叠的罕见细胞，可以做个标记用于后续进一步的分析  
3. 将数据集映射到一个保守型低维空间，使用非线性规整算法对特征尺度差异进行标准化  
4. 对整合的数据做下游分析，例如通过聚类区分不同的细胞亚群，或者重构连续性发育过程  
5. 对不同数据集对齐后的亚群做比较分析，从而确定群体密度或者基因表达的差异  
  
# 找出不同数据集之间共享的关联结构  

